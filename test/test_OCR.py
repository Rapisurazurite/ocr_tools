from unittest import TestCase

from PIL import Image

from tools import Matpix_MyAccount, capture, ClipBoardManager, Bing_LaTex_OCR


class TestMatpix_MyAccount(TestCase):
    def test_image_uri(self):
        if capture() != 2:
            raise Exception("未进行截图")
        imgIo = ClipBoardManager.get_image_from_clipboard()
        img = Image.open(imgIo)
        img.save("save.png", "png")
        uri1 = Matpix_MyAccount.image_uri("save.png")
        uri2 = Matpix_MyAccount.image_uri(imgIo)
        return uri1 == uri2

    def test_matpix_ocr(self):
        data = """data:image/jpeg;base64,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
YII="""
        res = Matpix_MyAccount.matpix_ocr(data, 5)
        print(res)


class TestBing_LaTex_OCR(TestCase):
    def test_bing_ocr(self):
        if capture() != 2:
            raise Exception("未进行截图")
        imgIo = ClipBoardManager.get_image_from_clipboard()
        img = Image.open(imgIo)
        img.save("save.png", "png")
        print(Bing_LaTex_OCR.bing_ocr("save.png"))

    def test_ocr(self):
        self.fail()
